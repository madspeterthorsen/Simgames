---
import Layout from "../layouts/Layout.astro";

interface Game {
  id: number;
  title: string;
  img: string;
}
const SUPABASE_URL = "https://wxjylkvjfnoijclnsffw.supabase.co";
const SUPABASE_KEY = import.meta.env.PUBLIC_SUPABASE_KEY || "sb_secret_jAuh8XhtJtcsYsH5yPDOYw_igg62J3R";

const res = await fetch(`${SUPABASE_URL}/rest/v1/games?select=*`, {
  headers: {
    apikey: SUPABASE_KEY,
  },
});

const data = await res.json();
const games: Game[] = Array.isArray(data) ? data : [];
---

<Layout>
  <div class="cloud-layer">
    <img src="/sky.webp" class="cloud cloud-1" alt="" aria-hidden="true" />
    <img src="/sky.webp" class="cloud cloud-2" alt="" aria-hidden="true" />
    <img src="/sky.webp" class="cloud cloud-3" alt="" aria-hidden="true" />
  </div>
  <style>
    :root {
      --accent: #00eaff;
    }

    .hero {
      max-width: 900px;
      margin: 0 auto;
      padding-top: 12rem;
      padding-bottom: 5rem;
      text-align: center;
      position: relative;
      z-index: 2;
    }

    p {
      text-align: justify;
      padding: 20px;
    }

    .hero-text h1 {
      margin: 0 0 0.5rem 0;
      font-size: 2.6rem;
      letter-spacing: 2px;
    }
    .hero-text h2 {
      margin: 0;
      font-size: 1.25rem;
      opacity: 0.9;
    }

    .hero-text h1 {
      margin: 0 0 0.5rem 0;
      font-size: 2.6rem;
      letter-spacing: 2px;
    }

    .hero-text h2 {
      margin: 0;
      font-size: 1.25rem;
      opacity: 0.9;
    }

    .hero-gif-wrapper {
      width: 100%;
      max-width: 900px;
      margin-top: 3rem;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 0 40px rgba(255, 255, 255, 0.35);
      background: transparent;
    }

    .section-title {
      margin-top: 6.5rem;
      margin-bottom: 0.4rem;
      text-align: center;
      font-size: 1.7rem;
      letter-spacing: 2px;
    }

    .hero-gif {
      width: 100%;
      max-height: 370px;
      object-fit: cover;
      display: block;
      border-radius: 15px;
      border: none;
      background: transparent;
    }

    .section-title {
      margin-top: 7rem;
      margin-bottom: 1.2rem;
      text-align: center;
      font-size: 1.7rem;
      letter-spacing: 2px;
    }

    .section-title-two {
  margin-top: 6rem;
  margin-bottom: 2rem;
  text-align: center;
  font-size: 1.7rem;
  letter-spacing: 2px;
}


    .carousel-section {
      max-width: 900px;
      margin: 0 auto 8rem;
      padding: 20px 40px;
      position: relative;
      z-index: 2;
    }

    .carousel-window {
      overflow: hidden;
      padding: 20px 20px;
    }

    .carousel-track {
      display: flex;
      gap: 20px;
      transition: transform 0.35s ease;
      width: max-content;
      margin: 0 auto;
    }
    .card {
      width: 160px;
      height: 220px;
      border-radius: 15px;
      overflow: hidden;
      flex-shrink: 0;
      cursor: pointer;
      background: rgba(0, 0, 0, 0.04);
    }
    .card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .card:hover {
      transform: translateY(-8px) scale(1.05);
      transition: transform 0.22s ease;
    }

    .concept-section {
      max-width: 900px;
      margin: 1.25rem auto 3.5rem;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 2rem;
      line-height: 1.6;
      position: relative;
      z-index: 2;
    }

    .arrow-wrap {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 0.5rem;
    }

    .arrow-btn {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
    }

    .arrow-btn img {
      width: 80px;
      height: 80px;
      transition: transform 0.15s ease;
    }

    .arrow-btn:hover img {
      transform: scale(1.12);
    }

    .player-arrow {
      background: none;
      border: none;
      cursor: pointer;
      z-index: 20;
      padding: 0;
    }

    .player-arrow img {
      width: 64px;
      height: 64px;
      transition: transform 0.18s ease;
      display: block;
      margin-top: -25px;
    }

    .player-arrow img:hover {
      transform: scale(1.08);
    }

    .player-carousel {
      max-width: 800px;
      margin: 4rem auto 10rem;
      padding: 1.25rem 20px;
      border-radius: 15px;
      background: rgba(0, 0, 0, 0.35);
      border: 3px solid rgba(255, 255, 255, 0.35);
      box-shadow: 0 0 50px rgba(255, 255, 255, 0.15);
      display: grid;
      align-items: center;
      position: relative;
      text-align: left;
      z-index: 2;
    }

    .player-arrow-row {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 1.5rem;
    }

    .player-arrow {
      background: none;
      border: none;
      cursor: pointer;
      z-index: 20;
      padding: 0;
    }
    .player-arrow img {
      width: 64px;
      height: 64px;
      transition: transform 0.18s ease;
      display: block;
    }
    .player-arrow img:hover {
      transform: scale(1.08);
    }

    .player-slide-wrapper {
      width: 100%;
      overflow-x: scroll;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
    }

    .player-track {
      display: flex;
      transition: transform 0.45s cubic-bezier(0.2, 0.8, 0.2, 1);
      will-change: transform;
      width: 100%;
    }

    .player-track {
      display: flex;
      width: 100%;
    }

    .player-slide {
      flex: 0 0 100%;
      width: 100%;
      scroll-snap-align: start;
      box-sizing: border-box;
      padding: 1.25rem 1.5rem;
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 1.5rem;
      align-items: center;
    }

    .player-card-img {
      width: 100%;
      height: 250px;
      border-radius: 12px;
      overflow: hidden;
      position: relative;
      background: #00eaff;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .player-card-img img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    .player-card-label {
      position: absolute;
      bottom: 10px;
      left: 14px;
      font-size: 1.05rem;
    }

    .player-card-text h3 {
      margin: 0 0 1rem 0;
      font-size: 1.9rem;
      line-height: 1.12;
    }

    .player-card-text ul {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 1.05rem;
      line-height: 1.6;
    }

    .player-card-text ul li::before {
      content: "• ";
      color: var(--accent);
    }

    .player-card-text ul li + li {
      margin-top: 0.4rem;
    }

    .book-btn {
  display: flex;
  justify-content: flex-start;
  margin-top: 1.75rem;
}

.book-link {
  position: relative;
  display: inline-block;
}

.book-base,
.book-hover {
  width: 180px;
  height: auto;
  display: block;
  image-rendering: pixelated;
  transition: opacity 0.25s ease, transform 0.25s ease;
}

.book-hover {
  position: absolute;
  inset: 0;
  opacity: 0;
  pointer-events: none;
}

.book-link:hover .book-hover {
  opacity: 1;
}

.book-link:hover .book-base {
  opacity: 0;
}

.book-link:hover img {
  transform: scale(1.02);
}


    .concept-right {
      display: flex;
      flex-direction: column;
    }

    .player-card-img {
      width: 100%;
      height: 250px;
      border-radius: 12px;
      overflow: hidden;
      position: relative;
      background: #00eaff;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .player-card-img img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }
    .player-card-label {
      position: absolute;
      bottom: 10px;
      left: 14px;
      font-size: 1.05rem;
    }

    .player-card-text h3 {
      margin: 0 0 1rem 0;
      font-size: 1.9rem;
      line-height: 1.12;
    }
    .player-card-text ul {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 1.05rem;
      line-height: 1.6;
    }

    .book-btn {
      display: flex;
      justify-content: flex-start;
      margin-top: 1.75rem;
    }

    .book-btn img {
      width: 180px;
      height: auto;
      cursor: pointer;
      transition: transform 0.25s ease;
      image-rendering: pixelated;
    }

    .book-btn img:hover {
      content: url("/bookhover.png");
      transform: scale(1.02);
    }

    .koncept-btn {
      margin-top: 1rem;
      align-self: flex-end;
      margin-right: 130px;
    }

    .koncept-btn img {
      width: 180px;
      height: auto;
      cursor: pointer;
      transition: transform 0.15s ease;
      image-rendering: pixelated;
    }

    .koncept-btn img:hover {
      content: url("/koncepthover.webp");
      transform: scale(1.05);
    }

    .cta-wrap {
      text-align: center;
      margin-top: 2.5rem;
    }

    .cta-button {
      padding: 0.8rem 2rem;
      border-radius: 999px;
      border: 2px solid var(--accent);
      background: none;
      color: var(--accent);
      cursor: pointer;
    }

    .footer {
      margin-top: 4rem;
      height: 80px;
      background: url("/footer.png");
      background-size: cover;
      position: relative;
      z-index: 2;
    }

    .cloud-layer {
      position: fixed;
      top: 80px;
      left: 0;
      width: 100%;
      height: calc(100vh - 80px);
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .cloud {
      position: absolute;
      width: 360px;
      opacity: 0.18;
      transition: transform 0.1s linear;
    }

    .cloud-1 {
      top: 4%;
      left: -6%;
    }

    .cloud-2 {
      top: 14%;
      right: -8%;
      width: 420px;
    }

    .cloud-3 {
      top: 26%;
      left: 12%;
      width: 300px;
    }

   /* 
  MOBILE FIX
  Rydder op i overflow, sliders og spacing.
  Fokus: det skal bare virke – ingen fancy hacks.
*/
@media (max-width: 820px) {

/* ========== HERO ========== */
/* Mindre padding så hero ikke fylder hele skærmen */
.hero {
  padding: 6rem 1rem 3rem;
}

/* Skaler tekst ned – intet behov for desktop-størrelser */
.hero-text h1 {
  font-size: 2rem;
  letter-spacing: 1px;
}

.hero-text h2 {
  font-size: 1rem;
}

/* Video må ikke dominere viewport */
.hero-gif {
  max-height: 220px;
}

/* ========== SECTION TITLES ========== */
.section-title {
  margin-top: 3rem;
  font-size: 1.2rem;
  letter-spacing: 1px;
}

/* Fjern aggressive negative margins – de ødelægger mobil */
.section-title-two {
  margin-top: 2.5rem;
  font-size: 1.2rem;
  text-align: center;
}

/* ========== KONCEPT ========== */
/* Stack content – ingen grund til columns på mobil */
.concept-section {
  grid-template-columns: 1fr;
  gap: 1.5rem;
  padding: 0 1rem;
}

.concept-right {
  align-items: center;
}

.koncept-btn {
  align-self: center;
  margin-right: 0;
}

.koncept-btn img {
  width: 140px;
}

/* ========== GAMES / CAROUSEL ========== */
/* Lås visningen til 2 cards – resten skjules */
.carousel-window {
  max-width: 260px; /* 2 × 120px + gap */
  margin: 0 auto;
  overflow: hidden;
}

/* Cards skal være mindre på mobil */
.card {
  width: 120px;
  height: 160px;
}

.carousel-track {
  gap: 20px;
}

.arrow-btn img {
  width: 56px;
  height: 56px;
}

/* ========== PICK PLAYER ========== */
/* Fjern side-margins – de skubber indhold ud af viewport */
.player-carousel {
  width: 100%;
  margin: 3rem 0 6rem;
  padding: 1rem;
  box-sizing: border-box;
}

/* Stop horizontal scroll – vi styrer slideren selv */
.player-slide-wrapper {
  width: 100%;
  overflow: hidden;
}

/* Slides må aldrig være bredere end viewport */
.player-slide {
  width: 100%;
  flex: 0 0 100%;
  grid-template-columns: 1fr;
  gap: 1rem;
  padding: 0.75rem;
  box-sizing: border-box;
}

.player-card-img {
  height: 200px;
}

.player-card-text h3 {
  font-size: 1.4rem;
  text-align: center;
}

.player-card-text ul {
  font-size: 0.95rem;
  text-align: center;
  padding: 0;
  margin: 0;
}

.book-btn {
  justify-content: center;
}

.book-btn img {
  width: 150px;
}

/* Pile skal være tæt på hinanden – ikke ude i siden */
.player-arrow-row {
  display: flex;
  justify-content: center;
  gap: 2.5rem;
  margin-top: 1rem;
}

/* ========== BACKGROUND CLOUDS ========== */
/* Mindre clouds så de ikke stjæler fokus */
.cloud {
  width: 220px;
}
}

  </style>

  <section class="hero reveal">
    <div class="hero-text">
      <h1>THE CLUBHOUSE</h1>
      <h2>Simulatorgolf. Challenges. Vibes. Fællesskab.</h2>
    </div>
    <div class="hero-gif-wrapper">
      <video class="hero-gif" src="/videos/hero.mp4" autoplay muted loop playsinline></video>
    </div>
  </section>

  <h2 class="section-title">KONCEPT</h2>
  <div class="concept-section reveal">
    <p>
      The Clubhouse er et socialt oplevelsesunivers, hvor simulatorgolf møder gamingkultur, events og højt humør. Her handler det ikke om handicap eller teknik – men om energi, udfordringer og fællesskab. Med TrackMan-minigames, sjove konkurrencer og
      et dynamisk miljø skabt til både venner, dates og grupper, bliver golf pludselig til en leg, som alle kan være med i. Det er et sted, hvor grin, high-fives og små triumfer skaber stemningen, og hvor aftener hurtigt udvikler sig til noget, man
      taler om længe efter.
    </p>
    <div class="concept-right">
      <p>
        Derfor er The Clubhouse også oplagt til events: firmaaftener, fødselsdage, polterabender, studietræf eller bare en spontan aften ude. Her får du en oplevelse, hvor sport, gaming og social hygge smelter sammen – med kolde øl, dæmpet lys, god
        musik og minigames der holder tempoet højt.
      </p>
      <div class="koncept-btn">
        <a href="/faq"><img src="/koncept.webp" alt="Koncept" /> </a>
      </div>
    </div>
  </div>

  <h2 class="section-title">TRACKMAN MINIGAMES & CHALLENGES</h2>
  <section class="carousel-section reveal">
    <div class="carousel-window">
      <div class="carousel-track" id="carouselTrack">
        {
          games.length > 0 ? (
            games.map((game, idx) => (
              <a class="card" href={`/${game.id}`} data-index={idx}>
                <img src={game.img} alt={game.title} />
              </a>
            ))
          ) : (
            <div class="card">
              <img src="/placeholder.png" alt="Coming soon" />
            </div>
          )
        }
      </div>
    </div>
    <div class="arrow-wrap">
      <button class="arrow-btn" id="arrowLeft"><img src="/arrow-left.webp" alt="Left" /></button>
      <button class="arrow-btn" id="arrowRight"><img src="/arrow-right.webp" alt="Right" /></button>
    </div>
  </section>

  <h2 class="section-title-two">HVILKEN SPILLER ER DU?</h2>

  <section class="player-carousel reveal">
    <div class="player-slide-wrapper" id="playerWrapper">
      <div class="player-track" id="playerTrack">
        <!-- SLIDE 1 -->
        <div class="player-slide">
          <div class="player-card-img">
            <img src="/player1.webp" />
            <div class="player-card-label">PLAYER 1</div>
          </div>
          <div class="player-card-text">
            <h3>INSTA-QUEEN</h3>
            <ul>
              <li>Poster film af hvert slag</li><br />
              <li>Snakker om sit slag resten af året</li><br />
              <li>Har ét godt slag per aften</li>
            </ul>
            <div class="book-btn">
              <a href="/booking" class="book-link">
                <img src="/book.webp" alt="Book Now" class="book-base" />
                <img src="/bookhover.webp" alt="" class="book-hover" />
              </a>
            </div>
            
          </div>
        </div>

        <div class="player-slide">
          <div class="player-card-img">
            <img src="/player2.webp" />
            <div class="player-card-label">PLAYER 2</div>
          </div>
          <div class="player-card-text">
            <h3>ØL-MESTEREN</h3>
            <ul>
              <li>Bliver bedre for hver tår</li><br />
              <li>Tager spillet useriøst men vinder alligevel</li><br />
              <li>“Et slag mere – for hyggen!”</li>
            </ul>
            <div class="book-btn">
              <a href="/booking" class="book-link">
                <img src="/book.webp" alt="Book Now" class="book-base" />
                <img src="/bookhover.webp" alt="" class="book-hover" />
              </a>
            </div>
          </div>
        </div>

        <div class="player-slide">
          <div class="player-card-img">
            <img src="/player3.webp" />
            <div class="player-card-label">PLAYER 3</div>
          </div>
          <div class="player-card-text">
            <h3>TRYHARD'EREN</h3>
            <ul>
              <li>Ankommer med handsker og tees</li><br />
              <li>Analyserer hvert slag</li><br />
              <li>Stille hvis du slår længere</li>
            </ul>
           <div class="book-btn">
              <a href="/booking" class="book-link">
                <img src="/book.webp" alt="Book Now" class="book-base" />
                <img src="/bookhover.webp" alt="" class="book-hover" />
              </a>
            </div>
          </div>
        </div>

        <div class="player-slide">
          <div class="player-card-img">
            <img src="/player4.webp" />
            <div class="player-card-label">PLAYER 4</div>
          </div>
          <div class="player-card-text">
            <h3>FORBIEREN</h3>
            <ul>
              <li>“Jeg plejer at være bedre!”</li><br />
              <li>Skyder 500m… eller 5cm</li><br />
              <li>Har uheld i verdensklasse</li>
            </ul>
            <div class="book-btn">
              <a href="/booking" class="book-link">
                <img src="/book.webp" alt="Book Now" class="book-base" />
                <img src="/bookhover.webp" alt="" class="book-hover" />
              </a>
            </div>
          </div>
        </div>

        <div class="player-slide">
          <div class="player-card-img">
            <img src="/player5.webp" />
            <div class="player-card-label">PLAYER 5</div>
          </div>
          <div class="player-card-text">
            <h3>HYGGESPILLEREN</h3>
            <ul>
              <li>Med for stemningen</li><br />
              <li>Ler højere end alle andre</li><br />
              <li>Bedste slag – ved et uheld</li><br />
            </ul>
            <div class="book-btn">
              <a href="/booking" class="book-link">
                <img src="/book.webp" alt="Book Now" class="book-base" />
                <img src="/bookhover.webp" alt="" class="book-hover" />
              </a>
            </div>
          </div>
        </div>

        <div class="player-slide">
          <div class="player-card-img">
            <img src="/player6.webp" />
            <div class="player-card-label">PLAYER 6</div>
          </div>
          <div class="player-card-text">
            <h3>DEN TAVSE SNIGSKYTTE</h3>
            <ul>
              <li>Rammer alt – siger intet</li><br />
              <li>Speedrunner TrackMan</li><br />
              <li>Vinder uden at prøve</li>
            </ul>
            <div class="book-btn">
              <a href="/booking" class="book-link">
                <img src="/book.webp" alt="Book Now" class="book-base" />
                <img src="/bookhover.webp" alt="" class="book-hover" />
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="player-arrow-row">
      <button class="player-arrow" id="playerPrev">
        <img src="/arrow-left.webp" alt="Previous" />
      </button>
      <button class="player-arrow" id="playerNext">
        <img src="/arrow-right.webp" alt="Next" />
      </button>
    </div>
  </section>

  <div class="footer"></div>

  <script is:inline>
    (function () {
      const track = document.getElementById("carouselTrack");
      if (!track) return;
      const prevBtn = document.getElementById("arrowLeft");
      const nextBtn = document.getElementById("arrowRight");
      const gap = 20;
      let isAnimating = false;

      // Sørg for jævn animation
      track.style.willChange = "transform";

      function getStepWidth() {
        const firstCard = track.querySelector(".card");
        if (!firstCard) return 0;
        const rect = firstCard.getBoundingClientRect();
        return rect.width + gap;
      }

      function slideNext() {
        if (isAnimating) return;
        const step = getStepWidth();
        if (!step) return;

        isAnimating = true;
        track.style.transition = "transform 0.35s ease";
        track.style.transform = `translate3d(${-step}px, 0, 0)`;

        const handle = () => {
          track.style.transition = "none";
          const first = track.firstElementChild;
          if (first) track.appendChild(first);
          track.style.transform = "translate3d(0, 0, 0)";

          // Force reflow før vi genaktiverer transition
          void track.offsetHeight;
          track.style.transition = "transform 0.35s ease";

          isAnimating = false;
          track.removeEventListener("transitionend", handle);
        };

        track.addEventListener("transitionend", handle);
      }

      function slidePrev() {
        if (isAnimating) return;
        const step = getStepWidth();
        if (!step) return;

        isAnimating = true;
        track.style.transition = "none";
        const last = track.lastElementChild;
        if (last) track.insertBefore(last, track.firstElementChild);
        track.style.transform = `translate3d(${-step}px, 0, 0)`;

        // Force reflow og animér tilbage til 0
        void track.offsetHeight;
        track.style.transition = "transform 0.35s ease";
        track.style.transform = "translate3d(0, 0, 0)";

        const handle = () => {
          isAnimating = false;
          track.removeEventListener("transitionend", handle);
        };

        track.addEventListener("transitionend", handle);
      }

      prevBtn && (prevBtn.onclick = slidePrev);
      nextBtn && (nextBtn.onclick = slideNext);

      document.addEventListener("keydown", (e) => {
        if (e.key === "ArrowLeft") slidePrev();
        if (e.key === "ArrowRight") slideNext();
      });
    })();

    (function () {
      const wrapper = document.getElementById("playerWrapper");
      const track = document.getElementById("playerTrack");
      if (!wrapper || !track) return;
      const slides = Array.from(track.children);
      const next = document.getElementById("playerNext");
      const prev = document.getElementById("playerPrev");

      function update() {
        const slideW = wrapper.clientWidth;
        track.style.transform = `translate3d(${-index * slideW}px, 0, 0)`;
      }

      let index = 0;

      next &&
        (next.onclick = () => {
          index = Math.min(index + 1, slides.length - 1);
          update();
        });

      prev &&
        (prev.onclick = () => {
          index = Math.max(index - 1, 0);
          update();
        });

      window.addEventListener("resize", update);

      update();
    })();
    (function () {
      const clouds = document.querySelectorAll(".cloud");
      if (!clouds.length) return;

      const maxMove = window.innerWidth + 600;

      window.addEventListener("scroll", () => {
        const progress = Math.min(window.scrollY / 600, 1);

        clouds.forEach((cloud, i) => {
          const direction = i % 2 === 0 ? -1 : 1;
          const offset = progress * maxMove;
          cloud.style.transform = `translateX(${direction * offset}px)`;
        });
      });
    })();
  </script>
</Layout>
